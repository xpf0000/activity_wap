function getCategory(a){Service.articleGetCategory(function(b){var c=b.data.info;c&&a(c)})}function checkLogin(){return null==User.username||void 0==User.username||""==User.username?(mainView.router.loadPage({url:"login.html",modal:!0}),!1):!0}var Vue,$$,Service,ActivityListPageModel={running:!1,page:1,pagesize:10,end:!1,id:"",category_id:"",user:{},reset:function(){this.page=1,this.pagesize=10,this.end=!1,this.running=!1},handleData:function(a,b){var c=a.data.info;c&&(c.length<this.pagesize?this.end=!0:(this.end=!1,this.page+=1),$$.each(c,function(a,b){b.timestr=DateTimeUtil.UnixToDate(b.create_time)}),b(c,this.end)),this.running=!1},getlist:function(a){if(!this.end&&!this.running){this.running=!0;var b=this;Service.articleGetList(this.category_id,this.page,this.pagesize,function(c){b.handleData(c,a)})}},getUserPostlist:function(a){if(!this.end&&!this.running){this.running=!0;var b=this;Service.usersGetArticleList(this.user,this.page,this.pagesize,function(c){b.handleData(c,a)})}},getUserCollectlist:function(a){if(!this.end&&!this.running){this.running=!0;var b=this;Service.usersGetCollectList(this.user,this.page,this.pagesize,function(c){b.handleData(c,a)})}},getUserJoinlist:function(a){if(!this.end&&!this.running){this.running=!0;var b=this;Service.usersGetJoinList(this.user,this.page,this.pagesize,function(c){b.handleData(c,a)})}},getJoinlist:function(a){if(!this.end&&!this.running){this.running=!0;var b=this;Service.articleGetJoinList(this.id,this.page,this.pagesize,function(c){b.handleData(c,a)})}}},handleInfiniteScroll=function(){var g,a=$$(this),b=a[0].scrollTop,c=a[0].scrollHeight,d=a[0].offsetHeight,e=a[0].getAttribute("data-distance"),f=a.find(".virtual-list"),h=a.hasClass("infinite-scroll-top");if(e||(e=50),"string"==typeof e&&e.indexOf("%")>=0&&(e=parseInt(e,10)/100*d),e>d&&(e=d),h)e>b&&a.trigger("infinite");else if(b+d>=c-e){if(f.length>0&&(g=f[0].f7VirtualList,g&&!g.reachEnd))return;a.trigger("infinite")}},myApp=null,User={id:"",uid:"",username:"",nickname:"尚未登录",headimage:"images/user_face02.jpg",msg:"登录"};requirejs(["main"],function(){require(["vue","store","Service","share","wx","xupload","toast","auislide"],function(a,b,c,d,e){function g(a){var c;c=null!=a&&void 0!=a?a:b.get("user"),null!=c&&void 0!=c&&(User=c,Service.userGetUserInfo(User,function(a){var d,c=a.data.info;if(c.length>0){d=c[0],b.set("user",d),User=d,User.msg="退出登录";try{l.uinfo=User}catch(e){}}}))}function h(){function a(){}function f(){Service.commonGetGuanggao("7",function(a){var b=a.data.info;b&&(d.info=b)})}function h(a,c){e.info=e.info.concat(a),c&&(b.msg="已全部加载完毕",b.end=!0)}var b,c,d,e,g;$$(".infinite-scroll").on("infinite",function(){g.getlist(h)}),b=new Vue({el:"#page_load",data:{msg:"信息加载中...",end:!1}}),c=new Vue({el:"#nav",data:{info:[]}}),d=new Vue({el:"#aui-slide",data:{info:[]},updated:function(){new auiSlide({container:document.getElementById("aui-slide"),height:120,speed:300,pageShow:!0,pageStyle:"dot",loop:!0,dotPosition:"center",currentPage:a})}}),e=new Vue({el:"#index_list",data:{info:[]},methods:{toInfo:function(a){var b=Number(e.info[a].view)+1;e.info[a].view=b+"",mainView.router.loadPage({url:"info.html?id="+e.info[a].id})}},updated:function(){}}),f(),getCategory(function(a){var b,d;a.length>4?(b=a.splice(0,4),c.info=b,d={id:0,title:"全部",url:"images/class_icon01.png"},c.info.push(d)):(c.info=a,d={id:0,title:"全部",url:"images/class_icon01.png"},c.info.push(d))}),g=Object.create(ActivityListPageModel),g.getlist(h),OnNotice("addActivitySuccess",function(){e.info=[],g.reset(),g.getlist(h)})}function j(a){function g(a,b){e.list=e.list.concat(a),b&&(e.msg="已全部加载完毕",e.end=!0)}var f,b=a.id,c=a.title,d=new Vue({el:"#filter",data:{category:[]},methods:{chooseid:function(a,b){e.filter.id!=a&&(e.filter.id=a,e.filter.title=b,e.msg="加载中...",e.end=!1,e.list=[],f.category_id=a,f.reset(),f.getlist(g))}}}),e=new Vue({el:"#list",data:{msg:"信息加载中...",end:!1,filter:{id:"",title:"",time:"",price:""},list:[]},methods:{toInfo:function(a){var b=Number(e.list[a].view)+1;e.list[a].view=b+"",mainView.router.loadPage({url:"info.html?id="+e.list[a].id})}}});null!=b&&void 0!=b&&(e.filter.id=b),null!=c&&void 0!=c&&(e.filter.title=c),f=Object.create(ActivityListPageModel),f.category_id=e.filter.id,f.getlist(g),getCategory(function(a){var b=a,c={id:0,title:"全部",url:"images/class_icon01.png"};b.push(c),d.category=b}),$$("#list").on("infinite",function(){f.getlist(g)}),$$("#list").on("scroll",handleInfiniteScroll)}function k(a){function e(){null!=User.id&&void 0!=User.id&&""!=User.id&&Service.usersGetUinfoList(User,function(a){var b=a.data.info;b&&(d.ulist=b)})}function f(){Service.articleGetEvent(a,function(a){var b,c,e;0==a.data.code&&(b=a.data.info,b&&(c=b[0],c.s_str=DateTimeUtil.UnixToDate(c.s_time),c.e_str=DateTimeUtil.UnixToDate(c.e_time),e=d.info,d.info=c,d.info.r_number=e.r_number))})}var b=new Vue({el:"#info",data:{info:{},list:[]}}),c=new Vue({el:"#info_bottom",data:{orcollect:"",type:"1",orjoin:"",btitle:"报名"},methods:{joinclick:function(){checkLogin()&&(""==c.orjoin?myApp.popup(".picker_b"):Service.usersDelJoin(b.info.id,User,function(a){if(a){c.orjoin="",c.btitle="报名",r(b.info.id);var e=Number(d.info.r_number)-1;d.info.r_number=e+"",b.info.r_number=e+""}}))},doCollect:function(){checkLogin()&&(""==c.orcollect?Service.articleAddCollect(b.info.id,User,function(a){a&&(c.orcollect="2")}):Service.usersDelCollect(b.info.id,User,function(a){a&&(c.orcollect="",r(b.info.id))}))}}}),d=new Vue({el:"#join",data:{ulist:[],info:{},uiid:"0",name:"",sex:"0",mobile:"",idcard:""},methods:{chooseUser:function(a){var b=d.ulist[a];d.uiid=b.id,d.name=b.name},doJoin:function(){var a,f;if(checkLogin()){if(0==d.name.length*d.mobile.length*d.idcard.length)return a=myApp.toast("请完善报名信息","",{}),a.show(),void 0;f=new FormData,f.append("id",b.info.id),f.append("uid",User.id),f.append("username",User.username),f.append("uiid",d.uiid),f.append("name",d.name),f.append("sex",d.sex),f.append("mobile",d.mobile),f.append("idcard",d.idcard),Service.articleAddJoin(f,function(a){if(a){c.orjoin="2",c.btitle="取消报名",myApp.closeModal(".picker_b"),e(),d.uiid="0",d.name="",d.sex="0",d.mobile="",d.idcard="";var f=Number(d.info.r_number)+1;d.info.r_number=f+"",b.info.r_number=f+""}})}}}});f(),e(),Service.articleGetArticle(a,User.id,function(a){var f,g,e=a.data.info;if(e){f=e[0],f.time=DateTimeUtil.UnixToDate(f.update_time);try{g=JSON.parse(f.content),$$.each(g,function(a,b){b.txt=b.txt.replaceAll("\n","<br/>    "),b.txt.length>0&&(b.txt="    "+b.txt)}),b.list=g}catch(h){}c.orcollect=null==f.orcollect||void 0==f.orcollect?"":0==f.orcollect?"":"2",null==f.orjoin||void 0==f.orjoin?(c.orjoin="",c.btitle="报名"):0==f.orjoin?(c.orjoin="",c.btitle="报名"):(c.orjoin="2",c.btitle="取消报名"),(null==f.headimage||void 0==f.headimage)&&(f.headimage="images/user_face02.jpg"),c.type=f.type,b.info=f,d.info.r_number=f.r_number,document.title=f.title}})}function m(){l=new Vue({el:"#user_index",data:{uinfo:User},methods:{toUserList:function(a){checkLogin()&&("4"==a?mainView.router.loadPage({url:"edit_password.html"}):mainView.router.loadPage({url:"user_info_list2.html?flag="+a}))},toUserEdit:function(){checkLogin()&&mainView.router.loadPage({url:"user_edit_info.html"})},logout:function(){checkLogin()&&(b.remove("user"),User={username:"",nickname:"尚未登录",headimage:"images/user_face02.jpg",msg:"登录"},l.uinfo=User)}}}),l.uinfo=User,l.uinfo.headimage||(l.uinfo.headimage="images/user_face02.jpg")}function n(){var a=new Vue({el:"#login",data:{account:"",pass:"",running:!1},methods:{doLogin:function(c){a.running||(a.running=!0,0==c&&Service.userLogin(a.account,a.pass,function(c){var e,f,h,j;if(c.data.code,e=c.data.msg,f=c.data.info,f.length>0){h=f[0];try{b.set("user",h)}catch(i){}return g(h),mainView.router.back({url:"index.html"}),void 0}j=myApp.toast(e,"",{}),j.show(),j.onDissMissListener(function(){a.running=!1})}))}}})}function o(){if(checkLogin()){var a=new Vue({el:"#user_edit_info",data:{headimg:"images/user_face02.jpg",birthday:"",nickname:"",sex:"0",address:"",username:"",truename:""},methods:{choosehead:function(){try{var b=window.URL||window.webkitURL;b.revokeObjectURL(a.headimg)}catch(c){}$$("#file").click()},fileChange:function(b){var d,e,f,c=b.target.files;c&&c.length>0&&(d=c[0],e=window.URL||window.webkitURL,f=e.createObjectURL(d),a.headimg=f)},doSubmit:function(){if(a.address=$$("#picker-dependent").val(),Service.userUserEdit(a,function(a){var d,b=a.data.code,c=a.data.msg;0==b&&(c="修改成功"),g(User),d=myApp.toast(c,"",{}),d.show()}),$$("#file")[0].files.length>0){var b=new FormData($$("#uploadHead")[0]);b.append("username",a.username),Service.userHeadEdit(b,function(){g(User)})}}}});User.headimage&&(a.headimg=User.headimage),a.username=User.username,a.nickname=User.nickname,a.address=User.address,a.birthday=User.birthday,a.sex=User.sex,""!=a.birthday&&$$("#calendar-default").val(DateTimeUtil.UnixToDate(a.birthday)),$$("#picker-dependent").val(a.address),myApp.calendar({input:"#calendar-default",formatValue:function(b,c){return a.birthday=c/1e3,DateTimeUtil.UnixToDate(c/1e3)}}),require(["city_picker"],function(){CityPicker.init("#picker-dependent",myApp)})}}function p(a){function e(a){var c,d,e;myApp.hidePreloader(),c=a.data.code,d=a.data.msg,0==c&&(d="发布成功",null!=b&&void 0!=b&&u(b,null),postNotice("addActivitySuccess")),e=myApp.toast(d,"",{}),e.show(),mainView.router.back({url:"index.html"})}var c,d,h,b=a.id;for((null==b||void 0==b)&&(b=getUrlParam("id")),c=new Vue({el:"#txtinput",data:{edittxt:""},methods:{txteditend:function(){var b,a=c.edittxt;d.isnew?(b={},b.txt=a,b.img="images/txt.png",d.list.splice(d.lastIndex,0,b)):d.lastIndex>=0&&d.lastIndex<d.list.length&&(d.list[d.lastIndex].txt=a),myApp.closeModal(".popup_a"),c.edittxt="",d.isnew=!1}}}),d=new Vue({el:"#publish",data:{list:[],lastindex:-1,cover:"http://images.ihlpp.cn/fengmian.jpg",coverid:"",isnew:!1,isactity:!1,title:"",nowindex:-1,clist:[],astyle:"none",s_time:"",e_time:"",price:"",a_number:"",address:"",cname:"",cid:""},methods:{showTxtEdit:function(a,b,e){d.isnew=b,b?c.edittxt="":null!=e&&void 0!=e&&(c.edittxt=e),myApp.popup(".popup_a"),d.lastIndex=a},chooseCover:function(){checkLogin()&&$$("#cover")[0].click()},chooseimg:function(a,b){checkLogin()&&(d.isnew=b,d.nowindex=a,b?($$("#mfile").click(),sendMsgToAPP({type:"0",msg:"选择多张图片"})):($$("#file").click(),sendMsgToAPP({type:"0",msg:"选择单张图片"})))},coverChange:function(a){var c,e,b=a.target.files;b.length&&(myApp.showPreloader("上传中..."),c={url:Service.BaseUrl+"Article.addPic",upBody:{uid:User.id,username:User.username}},c.upBlock=function(a,b){var c,e,f;myApp.hidePreloader(),null==b&&(c=a.data.code,e=a.data.info[0].id,f=a.data.info[0].url,0==c&&(d.coverid=e,d.cover=f))},e=new XImageUpload(c),e.upLoad(a))},imgChange:function(a){var c,e,f,b=a.target.files;b.length&&(c=d.nowindex,myApp.showPreloader("上传中..."),e={url:Service.BaseUrl+"Article.addPic",upBody:{uid:User.id,username:User.username}},e.upBlock=function(a,b){var e,f;myApp.hidePreloader(),null==b&&(e=a.data.code,f=a.data.info,0==e&&(d.isnew?(1!=d.list.length||""!=d.list[0].imgid&&void 0!=d.list[0].imgid||(d.list=[]),$$.each(f,function(a,b){var e={};e.txt="",e.img=b.url,e.imgid=b.id,d.list.splice(c,0,e),""==d.coverid&&a==f.length-1&&(d.coverid=b.id,d.cover=b.url)}),d.isnew=!1):(d.list[c].imgid=f[0].id,d.list[c].img=f[0].url,""==d.coverid&&(d.coverid=f[0].id,d.cover=f[0].url))))},f=new XImageUpload(e),f.upLoad(a))},addclick:function(a){$$("#p_upload_class"+a).show(),$$("#p_add"+a).hide(),d.lastindex>=0&&($$("#p_upload_class"+d.lastindex).hide(),$$("#p_add"+d.lastindex).show()),d.lastindex=a},clip:function(a){if(1==d.list.length){var b=myApp.toast("至少要有一张图片或文字","",{});return b.show(),void 0}a>=0&&d.list.splice(a,1)},moveup:function(a){var b,c;a>0&&(b=d.list[a],c=d.list[a-1],Vue.set(d.list,a,c),Vue.set(d.list,a-1,b))},movedown:function(a){var b,c;a<d.list.length-1&&(b=d.list[a],c=d.list[a+1],Vue.set(d.list,a,c),Vue.set(d.list,a+1,b))},doSubmit:function(){var a,c,f,g;return null==User.id||void 0==User.id||""==User.id?(mainView.router.loadPage({url:"login.html",modal:!0}),void 0):""==d.coverid?(a=myApp.toast("请选择封面","",{}),a.show(),void 0):""==d.title?(a=myApp.toast("请输入标题","",{}),a.show(),void 0):0==d.list.length?(a=myApp.toast("内容不能为空","",{}),a.show(),void 0):""==d.cname?(a=myApp.toast("请选择分类","",{}),a.show(),void 0):($$.each(d.clist,function(a,b){b.title==d.cname&&(d.cid=b.id)}),!d.isactity||""!=d.s_time&&""!=d.e_time&&""!=d.price+""&&""!=d.a_number+""?(c=[],$$.each(d.list,function(a,b){if(void 0!=b.txt&&""!=b.txt||void 0!=b.imgid&&""!=b.imgid){var d=b;(void 0==b.imgid||""==b.imgid)&&(d.imgid="",d.img=""),c.push(d)}}),0==c.length?(a=myApp.toast("请至少选择一张图片或文字","",{}),a.show(),void 0):(f=JSON.stringify(c).replace("点击这里输入照片说明",""),myApp.showPreloader("上传中..."),g=new FormData,g.append("uid",User.id),g.append("username",User.username),g.append("category_id",d.cid),g.append("title",d.title),g.append("cover_id",d.coverid),g.append("content",f),d.isactity?(g.append("s_time",d.s_time),g.append("e_time",d.e_time),g.append("price",d.price),g.append("a_number",d.a_number),g.append("address",d.address),null!=b&&void 0!=b?(g.append("aid",b),Service.articleEditEvent(g,function(a){e(a)})):Service.articleAddEvent(g,function(a){e(a)})):null!=b&&void 0!=b?(g.append("aid",b),Service.articleEditArticle(g,function(a){e(a)})):Service.articleAddArticle(g,function(a){e(a)}),void 0)):(a=myApp.toast("请完善活动信息","",{}),a.show(),void 0))},showActivity:function(){(null==b||void 0==b)&&(d.astyle=d.isactity?"block":"none")}}}),null!=b&&void 0!=b&&($$("#ckbox").attr("disabled",!0),Service.articleGetArticle(b,User.id,function(a){var c,e,b=a.data.info;b&&(c=b[0],d.coverid=c.cover_id,d.cover=c.url,d.title=c.title,d.isactity="2"==c.type,d.cid=c.category_id,$$.each(d.clist,function(a,b){b.id+""==d.cid+""&&(d.cname=b.title)}),d.astyle=d.isactity?"block":"none",e=JSON.parse(c.content),d.list=e)}),Service.articleGetEvent(b,function(a){var c,b=a.data.info;b&&(c=b[0],d.s_time=c.s_time,d.e_time=c.e_time,$$("#calendar-stime").val(DateTimeUtil.UnixToDate(d.s_time)),$$("#calendar-etime").val(DateTimeUtil.UnixToDate(d.e_time)),d.price=c.price,d.a_number=c.a_number,d.address=c.address)})),myApp.calendar({input:"#calendar-stime",formatValue:function(a,b){return d.s_time=b/1e3,DateTimeUtil.UnixToDate(b/1e3)}}),myApp.calendar({input:"#calendar-etime",formatValue:function(a,b){return d.e_time=b/1e3,DateTimeUtil.UnixToDate(b/1e3)}}),getCategory(function(a){d.clist=[],d.clist=a;var b=[];$$.each(a,function(a,c){b.push(c.title),c.id+""==d.cid+""&&(d.cname=c.title)}),myApp.picker({input:"#picker-device",formatValue:function(a,b){return d.cname=b[0],b},cols:[{textAlign:"center",values:b}]})}),i=0;1>i;i++)h={},h.txt="",h.img="images/addpic.png",d.list.push(h)}function r(a,b){function g(a,b){$$.each(a,function(a,b){b.timestr=DateTimeUtil.UnixToDate(b.create_time)}),q.list=q.list.concat(a),b&&(q.msg="已全部加载完毕",q.end=!0)}var c,d,e,f;if(null!=a){if(null==q||void 0==q)return;return c=-1,$$.each(q.list,function(b,d){d.id==a&&(c=b)}),c>=0&&(d=q.list,d.splice(c,1),q.list=d),void 0}switch(e=b.flag,(null==e||void 0==e)&&(e=getUrlParam("flag")),q=new Vue({el:"#user_info_list2",data:{msg:"信息加载中...",end:!1,list:[],pagetitle:""},methods:{toInfo:function(a){1==e?mainView.router.loadPage({url:"info_m.html?id="+a}):mainView.router.loadPage({url:"info.html?id="+a})}}}),f=Object.create(ActivityListPageModel),f.user=User,e){case"1":q.pagetitle="我发布的",f.getUserPostlist(g),$$("#user_info_list2").on("infinite",function(){f.getUserPostlist(g)});break;case"2":q.pagetitle="我收藏的",f.getUserCollectlist(g),$$("#user_info_list2").on("infinite",function(){f.getUserCollectlist(g)});break;case"3":q.pagetitle="我参与的",f.getUserJoinlist(g),$$("#user_info_list2").on("infinite",function(){f.getUserJoinlist(g)})}$$("#user_info_list2").on("scroll",handleInfiniteScroll),OnNotice("DelActivitySuccess",function(){switch(q.list=[],f.reset(),e){case"1":f.getUserPostlist(g);break;case"2":f.getUserCollectlist(g);break;case"3":f.getUserJoinlist(g)}})}function s(a){function g(a,b){$$.each(a,function(a,b){b.timestr=DateTimeUtil.UnixToDate(b.create_time)}),e.list=e.list.concat(a),b&&(e.msg="已全部加载完毕",e.end=!0)}var e,f,b=a.uid,c=a.nick,d=a.pic;(null==b||void 0==b)&&(b=getUrlParam("uid"),c=getUrlParam("nick"),d=getUrlParam("pic")),e=new Vue({el:"#user_info_list",data:{list:[],msg:"信息加载中...",end:!1,info:{nickname:c,headimage:d}},methods:{toInfo:function(a){var b=Number(e.list[a].view)+1;e.list[a].view=b+"",mainView.router.loadPage({url:"info.html?id="+e.list[a].id})}}}),f=Object.create(ActivityListPageModel),f.user={id:b},f.getUserPostlist(g),$$("#user_info_list").on("infinite",function(){f.getUserPostlist(g)}),$$("#user_info_list").on("scroll",handleInfiniteScroll)}function u(a,b){function d(){t.info={},t.einfo={},Service.articleGetArticle(t.id,User.id,function(a){var b,c;0==a.data.code&&(b=a.data.info,b&&(c=b[0],c.s_str=DateTimeUtil.UnixToDate(c.s_time),c.e_str=DateTimeUtil.UnixToDate(c.e_time),t.info=c))}),Service.articleGetEvent(t.id,function(a){var b,c;0==a.data.code&&(b=a.data.info,b&&(c=b[0],c.s_str=DateTimeUtil.UnixToDate(c.s_time),c.e_str=DateTimeUtil.UnixToDate(c.e_time),t.einfo=c))})}if(null!=a&&void 0!=a){if(null==t||void 0==t)return;return d(),void 0}var c=b.id;(null==c||void 0==c)&&(c=getUrlParam("id")),t=new Vue({el:"#info_m",data:{info:{},einfo:{},id:c},methods:{}}),d(),$$(".confirm-ok").on("click",function(){myApp.confirm("确定删除?","提醒",function(){Service.usersDelArticle(c,User,function(a){a&&(postNotice("DelActivitySuccess"),mainView.router.back({url:"index.html"}))})})})}function v(){function d(){var e,a=b.get("SMSSendTime");null!=a&&void 0!=a&&(e=((new Date).getTime()-a)/1e3,e=parseInt(e),60>e?(c.codebtn=60-e+"秒",setTimeout(function(){d()},1e3)):c.codebtn="获取验证码")}var c=new Vue({el:"#reg",data:{mobil:"",code:"",pass1:"",pass2:"",nickname:"",codebtn:"获取验证码",running:!1},methods:{sendMsg:function(){"获取验证码"==c.codebtn&&validatemobile(c.mobil)&&Service.userSmsSend(c.mobil,"1",function(a){b.set("SMSSendTime",(new Date).getTime()),a&&d()})},doReg:function(){var a;if(validatemobile(c.mobil)){if(""==c.code)return a=myApp.toast("请输入验证码","",{}),a.show(),void 0;if(""==c.nickname)return a=myApp.toast("请输入昵称","",{}),a.show(),void 0;if(""==c.pass1||""==c.pass2)return a=myApp.toast("请输入密码和确认密码","",{}),a.show(),void 0;if(c.pass1!=c.pass2)return a=myApp.toast("密码和确认密码不一致","",{}),a.show(),void 0;myApp.showPreloader("注册中..."),c.running||(c.running=!0,Service.userRegister(c.mobil,c.pass1,c.code,c.nickname,function(a){var e,f,h,j;if(myApp.hidePreloader(),a.data.code,e=a.data.msg,f=a.data.info,f.length>0){h=f[0];try{b.set("user",h)}catch(i){}return g(h),mainView.router.back({url:"index.html"}),void 0}j=myApp.toast(e,"",{}),j.show(),j.onDissMissListener(function(){c.running=!1})}))}}}});d()}function w(){function d(){var e,a=b.get("SMSSendTime");null!=a&&void 0!=a&&(e=((new Date).getTime()-a)/1e3,e=parseInt(e),60>e?(c.codebtn=60-e+"秒",setTimeout(function(){d()},1e3)):c.codebtn="获取验证码")}var c=new Vue({el:"#findpass",data:{mobil:"",code:"",pass1:"",pass2:"",codebtn:"获取验证码",running:!1},methods:{sendMsg:function(){"获取验证码"==c.codebtn&&validatemobile(c.mobil)&&Service.userSmsSend(c.mobil,"2",function(a){b.set("SMSSendTime",(new Date).getTime()),a&&d()})},doSubmit:function(){var a;if(validatemobile(c.mobil)){if(""==c.code)return a=myApp.toast("请输入验证码","",{}),a.show(),void 0;if(""==c.pass1||""==c.pass2)return a=myApp.toast("请输入密码和确认密码","",{}),a.show(),void 0;if(c.pass1!=c.pass2)return a=myApp.toast("密码和确认密码不一致","",{}),a.show(),void 0;myApp.showPreloader(""),c.running||(c.running=!0,Service.userUpdatePass(c.mobil,c.pass1,c.code,function(a){myApp.hidePreloader(),a&&mainView.router.back({url:"index.html"})}))}}}});d()}function x(){var a=new Vue({el:"#updatePass",data:{oldpass:"",pass1:"",pass2:"",running:!1},methods:{doSubmit:function(){var b;return""==a.oldpass||""==a.pass1||""==a.pass2?(b=myApp.toast("请输入原密码,新密码和确认密码","",{}),b.show(),void 0):a.pass1!=a.pass2?(b=myApp.toast("密码和确认密码不一致","",{}),b.show(),void 0):(myApp.showPreloader(""),a.running||(a.running=!0,Service.userUpdatePass2(User.mobile,a.oldpass,a.pass1,function(a){myApp.hidePreloader(),a&&mainView.router.back({url:"index.html"})})),void 0)}}})}function y(a){function e(a,b){c.list=c.list.concat(a),b&&(c.msg="已全部加载完毕",c.end=!0)}var c,d,b=a.id;(null==b||void 0==b)&&(b=getUrlParam("id")),c=new Vue({el:"#join_list",data:{list:[],msg:"信息加载中...",end:!1},methods:{toInfo:function(a){var b=Number(c.list[a].view)+1;c.list[a].view=b+"",mainView.router.loadPage({url:"info.html?id="+c.list[a].id})}}}),d=Object.create(ActivityListPageModel),d.id=b,d.getJoinlist(e),$$("#join_list").on("infinite",function(){d.getJoinlist(e)}),$$("#join_list").on("scroll",handleInfiniteScroll)}function z(){myApp.calendar({input:"#calendar-default"})}var l,q,t;Vue=a,$$=Dom7,Service=c,g(),$$(document).on("pageInit",function(a){var c,b=a.detail.page;if("index"==b.name)h();else if("list"==b.name)j(b.query);else if("info"==b.name)c=b.query.id,(null==c||void 0==c)&&(c=getUrlParam("id")),k(c);else if("user_index"==b.name)m();else if("login"==b.name)n();else if("user_edit_info"==b.name)setTimeout(function(){o()},1);else if("publish"==b.name)setTimeout(function(){p(b.query)},1);else{if("user_info_list2"==b.name)return setTimeout(function(){r(null,b.query)},1),void 0;"user_info_list"==b.name?setTimeout(function(){s(b.query)},1):"info_m"==b.name?setTimeout(function(){u(null,b.query)},1):"reg"==b.name?setTimeout(function(){v(b.query)},1):"findpass"==b.name?setTimeout(function(){w(b.query)},1):"updatePass"==b.name?setTimeout(function(){x()},1):"join_list"==b.name?setTimeout(function(){y(b.query)},1):"test"==b.name&&setTimeout(function(){z()},1)}}),$$(document).on("pageAfterBack",function(a){a.detail.page}),myApp=new Framework7({modalButtonOk:"确定",modalButtonCancel:"取消",pushStateSeparator:"",pushState:!0}),mainView=myApp.addView(".view-main",{}),t=null})});